# Test info

- Name: Checking role permissions >> Checking Admin permission >> Admin role can duplicate the structure page
- Location: /home/runner/work/qa-automated-tests/qa-automated-tests/e2e-tests/tests/ngf.test.js:577:9

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toContainText(expected)

Locator: getByText('/qa-automation-st-page-b9f8148d-6424-4cf9-af0b-419a80673200')
Expected string: "/qa-automation-st-page-b9f8148d-6424-4cf9-af0b-419a80673200"
Received: <element(s) not found>
Call log:
  - expect.toContainText with timeout 5000ms
  - waiting for getByText('/qa-automation-st-page-b9f8148d-6424-4cf9-af0b-419a80673200')

    at /home/runner/work/qa-automated-tests/qa-automated-tests/e2e-tests/tests/ngf.test.js:596:59
    at /home/runner/work/qa-automated-tests/qa-automated-tests/e2e-tests/tests/ngf.test.js:595:18
```

# Page snapshot

```yaml
- link "Mobalytics":
  - /url: /poe-2
  - img "Mobalytics"
- link "League of Legends LoL":
  - /url: https://stg.mobalytics.gg/lol
  - img "League of Legends"
  - text: LoL
- link "Teamfight Tactics TFT":
  - /url: https://stg.mobalytics.gg/tft
  - img "Teamfight Tactics"
  - text: TFT
- link "Path of Exile 2 PoE 2":
  - /url: https://stg.mobalytics.gg/poe-2
  - img "Path of Exile 2"
  - text: PoE 2
- link "Diablo 4 Diablo 4":
  - /url: https://stg.mobalytics.gg/diablo-4
  - img "Diablo 4"
  - text: Diablo 4
- link "Elden Ring Nightreign Nightreign New":
  - /url: https://stg.mobalytics.gg/elden-ring-nightreign
  - img "Elden Ring Nightreign"
  - text: Nightreign New
- link "Deadlock Deadlock":
  - /url: https://stg.mobalytics.gg/deadlock
  - img "Deadlock"
  - text: Deadlock
- link "Valorant VAL":
  - /url: https://stg.mobalytics.gg/valorant
  - img "Valorant"
  - text: VAL
- link "Monster Hunter Wilds Monster Hunter Wilds":
  - /url: https://stg.mobalytics.gg/mhw
  - img "Monster Hunter Wilds"
  - text: Monster Hunter Wilds
- link "Destiny 2 Destiny 2":
  - /url: https://stg.mobalytics.gg/destiny-2
  - img "Destiny 2"
  - text: Destiny 2
- link "Lost Ark Lost Ark":
  - /url: https://stg.mobalytics.gg/lost-ark
  - img "Lost Ark"
  - text: Lost Ark
- button:
  - img
- link "Example game ExG":
  - /url: https://stg.mobalytics.gg/example-game
  - img "Example game"
  - text: ExG
- link "The Bazaar The Bazaar":
  - /url: https://stg.mobalytics.gg/the-bazaar
  - img "The Bazaar"
  - text: The Bazaar
- link "Marvel Rivals Marvel Rivals":
  - /url: https://stg.mobalytics.gg/marvel-rivals
  - img "Marvel Rivals"
  - text: Marvel Rivals
- link "Zenless Zone Zero ZZZ New":
  - /url: https://stg.mobalytics.gg/zzz
  - img "Zenless Zone Zero"
  - text: ZZZ New
- link "win logo Download app":
  - /url: /lol/glp/download-welcome?Channel=web_dl_btn&utm_campaign=top-poe-2&utm_medium=homepage&utm_source=web
  - button "win logo Download app":
    - img "win logo"
    - text: Download app
- img
- textbox "global search input"
- text: Community
- img "settings"
- img "support"
- link "Home":
  - /url: /poe-2
  - img "Home"
- link "Profile":
  - /url: /poe-2/profile
  - img "Profile"
- link "Build Planner":
  - /url: /poe-2/planner/builds
  - img "Build Planner"
- link "Tier List":
  - /url: /poe-2/tier-list
  - img "Tier List"
- link "Starter Builds":
  - /url: /poe-2/starter-builds
  - img "Starter Builds"
- link "Builds":
  - /url: /poe-2/builds
  - img "Builds"
- link "Creators":
  - /url: /poe-2/creators
  - img "Creators"
- link "Guides":
  - /url: /poe-2/guides
  - img "Guides"
- main:
  - 'heading "error: something went terribly wrong..." [level=2]'
  - paragraph: Sorry for any inconvenience, we are trying our best but this is still work in progress and there might be issues.
- button "Do Not Sell or Share My Personal Information":
  - paragraph: Do Not Sell or Share My Personal Information
```

# Test source

```ts
  496 |   });
  497 |
  498 |   test(`Create a team page on ZZZ project`, async ({
  499 |     apiAuthAdmin,
  500 |     page,
  501 |     baseURL,
  502 |   }) => {
  503 |     await page.context().addCookies(apiAuthAdmin.cookies);
  504 |     const uniqueId = uuidv4();
  505 |     const pageName = `qa-automation-team-page-${uniqueId}`;
  506 |     const moba = new Moba(page);
  507 |
  508 |     await moba.mainURLs.openUgZzzPage(baseURL);
  509 |     await moba.ugProfilePage.gotoTeamPlannerPage();
  510 |     await moba.ugBuildPage.createGuide(pageName);
  511 |
  512 |     await test.step(`Expected Result: Team page with the name: ${pageName} is created on ZZZ project`, async () => {
  513 |       await expect(moba.ugBuildPage.header).toContainText("ZZZ Team");
  514 |       await expect(moba.ugBuildPage.controlPanel).toContainText(pageName);
  515 |     });
  516 |   });
  517 | });
  518 |
  519 | test.describe("Checking role permissions", () => {
  520 |   test.describe("Checking Admin permission", () => {
  521 |     test(`Admin role has access to the Admin ST page`, async ({
  522 |       apiAuthAdmin,
  523 |       page,
  524 |       baseURL,
  525 |     }) => {
  526 |       await page.context().addCookies(apiAuthAdmin.cookies);
  527 |       let adminTitle = "Structure Pages";
  528 |       const moba = new Moba(page);
  529 |
  530 |       await moba.mainURLs.openAdminPoePage(baseURL);
  531 |       await test.step(`Expected Result: Admin structure page is opened`, async () => {
  532 |         await expect(moba.stAdminPage.stAdminTitle(adminTitle)).toContainText(
  533 |           adminTitle
  534 |         );
  535 |       });
  536 |     });
  537 |
  538 |     test('St Widget contains "Edit" button, "Delete" button & "Create Page" button is present on ST page for Admin role', async ({
  539 |       page,
  540 |       apiAuthAdmin,
  541 |       baseURL,
  542 |     }) => {
  543 |       await page.context().addCookies(apiAuthAdmin.cookies);
  544 |       const moba = new Moba(page);
  545 |       let stWidgetName = "/qa-not-delete-st-page";
  546 |
  547 |       await moba.mainURLs.openAdminNightreignPage(baseURL);
  548 |
  549 |       await test.step('Expected Result: St Widget contains "Edit" button', async () => {
  550 |         await expect(moba.stAdminPage.editButton(stWidgetName)).toBeVisible();
  551 |       });
  552 |       await test.step('Expected Result: St Widget contains "Delete" button', async () => {
  553 |         await expect(moba.stAdminPage.deleteButton(stWidgetName)).toBeVisible();
  554 |       });
  555 |       await test.step('Expected Result: "Create Page" button is present on ST page for Admin role', async () => {
  556 |         await expect(moba.stAdminPage.createPageButton).toBeVisible();
  557 |       });
  558 |     });
  559 |
  560 |     test(`View mode of the "/qa-not-delete-st-page" structure page is available for the Admin role`, async ({
  561 |       apiAuthAdmin,
  562 |       page,
  563 |       baseURL,
  564 |     }) => {
  565 |       await page.context().addCookies(apiAuthAdmin.cookies);
  566 |       let stWidgetName = "/qa-not-delete-st-page";
  567 |
  568 |       const moba = new Moba(page);
  569 |
  570 |       await moba.mainURLs.openAdminNightreignPage(baseURL);
  571 |       await moba.stAdminPage.clickOnStWidget(stWidgetName);
  572 |       await test.step(`Expected Result: View mode the "/home" structure page is opened`, async () => {
  573 |         await expect(moba.stPage.stPageTitle).toContainText(stWidgetName);
  574 |       });
  575 |     });
  576 |
  577 |     test(`Admin role can duplicate the structure page`, async ({
  578 |       apiAuthAdmin,
  579 |       page,
  580 |       cleanupStPoEPages,
  581 |       baseURL,
  582 |     }) => {
  583 |       await page.context().addCookies(apiAuthAdmin.cookies);
  584 |       const uniqueId = uuidv4();
  585 |       const pageName = `/qa-automation-st-page-${uniqueId}`;
  586 |       const moba = new Moba(page);
  587 |       let stWidgetName = "/qa-not-delete-st-page";
  588 |
  589 |       await moba.mainURLs.openAdminPoePage(baseURL);
  590 |       await moba.stAdminPage.clickOnStWidget(stWidgetName);
  591 |       await moba.stPage.duplicateStPage(pageName);
  592 |       cleanupStPoEPages.addPageForCleanup(pageName); // Register page for deleting
  593 |       await moba.mainURLs.openAdminPoePage(baseURL);
  594 |
  595 |       await test.step(`Expected Result: ST page: ${pageName} is duplicated under Admin role`, async () => {
> 596 |         await expect(moba.stAdminPage.stWidget(pageName)).toContainText(
      |                                                           ^ Error: Timed out 5000ms waiting for expect(locator).toContainText(expected)
  597 |           pageName
  598 |         );
  599 |       });
  600 |     });
  601 |
  602 |     test(`Admin role can edit the structure page`, async ({
  603 |       apiAuthAdmin,
  604 |       page,
  605 |       cleanupStZzzPages,
  606 |       baseURL,
  607 |     }) => {
  608 |       await page.context().addCookies(apiAuthAdmin.cookies);
  609 |       const uniqueId = uuidv4();
  610 |       const pageName = `/qa-automation-st-page-${uniqueId}`;
  611 |       const moba = new Moba(page);
  612 |
  613 |       await moba.mainURLs.openAdminZzzPage(baseURL);
  614 |       await moba.stAdminPage.gotoStPlannerPage();
  615 |       await moba.stPage.addHeaderV2Widget();
  616 |       await moba.stPage.createStPage(pageName);
  617 |       cleanupStZzzPages.addPageForCleanup(pageName); // Register page for deleting
  618 |       await moba.stPage.editStPage();
  619 |
  620 |       await test.step(`Expected Result: Document Discovery is added to the st page: ${pageName} in edit mode`, async () => {
  621 |         await expect(moba.stPage.headerV2Widget).toBeVisible();
  622 |         await expect(moba.stPage.documentDiscoveryWidget).toBeVisible();
  623 |         await expect(moba.stPage.addSectionButton).not.toBeVisible();
  624 |         await expect(moba.stPage.dotsButton).toBeVisible();
  625 |       });
  626 |     });
  627 |
  628 |     test(`Admin role can delete the structure page on the ST page`, async ({
  629 |       apiAuthAdmin,
  630 |       page,
  631 |       baseURL,
  632 |     }) => {
  633 |       await page.context().addCookies(apiAuthAdmin.cookies);
  634 |       const uniqueId = uuidv4();
  635 |       const pageName = `/qa-automation-st-page-${uniqueId}`;
  636 |       const moba = new Moba(page);
  637 |
  638 |       await moba.mainURLs.openAdminDeadlockPage(baseURL);
  639 |       await moba.stAdminPage.gotoStPlannerPage();
  640 |       await moba.stPage.addHeaderV2Widget();
  641 |       await moba.stPage.createStPage(pageName);
  642 |       await moba.stPage.deleteStPage();
  643 |
  644 |       await test.step(`Expected Result: ST page: ${pageName} is deleted`, async () => {
  645 |         await expect(moba.stAdminPage.stWidget(pageName)).not.toBeVisible();
  646 |       });
  647 |     });
  648 |
  649 |     test(`Admin role is allowed to publish structure pages`, async ({
  650 |       apiAuthAdmin,
  651 |       page,
  652 |       cleanupStZzzPages,
  653 |       baseURL,
  654 |     }) => {
  655 |       await page.context().addCookies(apiAuthAdmin.cookies);
  656 |       const uniqueId = uuidv4();
  657 |       const pageName = `/qa-automation-st-page-${uniqueId}`;
  658 |       const moba = new Moba(page);
  659 |
  660 |       await moba.mainURLs.openAdminZzzPage(baseURL);
  661 |       await moba.stAdminPage.gotoStPlannerPage();
  662 |       await moba.stPage.addHeaderV2Widget();
  663 |       await moba.stPage.createStPage(pageName);
  664 |       cleanupStZzzPages.addPageForCleanup(pageName); // Register page for deleting
  665 |       await moba.stPage.publishStPage();
  666 |
  667 |       await test.step(`Expected Result: The ST page: ${pageName} is published`, async () => {
  668 |         await expect(moba.stPage.controlPanel).toContainText("Published");
  669 |       });
  670 |     });
  671 |
  672 |     test(`Admin role has access to SEO modal on the structure pages`, async ({
  673 |       apiAuthAdmin,
  674 |       page,
  675 |       baseURL,
  676 |     }) => {
  677 |       await page.context().addCookies(apiAuthAdmin.cookies);
  678 |       const moba = new Moba(page);
  679 |       let stWidgetName = "/qa-not-delete-st-page";
  680 |
  681 |       await moba.mainURLs.openAdminZzzPage(baseURL);
  682 |       await moba.stAdminPage.clickOnStWidget(stWidgetName);
  683 |       await moba.stPage.openSeoModal();
  684 |
  685 |       await test.step(`Expected Result: SEO modal is available for Admin role`, async () => {
  686 |         await expect(moba.stPage.seoModal).toBeVisible();
  687 |       });
  688 |     });
  689 |
  690 |     test(`Admin role can add VideoV2 widget (link) to the structure pages`, async ({
  691 |       apiAuthAdmin,
  692 |       page,
  693 |       cleanupStMhwPages,
  694 |       baseURL,
  695 |     }) => {
  696 |       await page.context().addCookies(apiAuthAdmin.cookies);
```